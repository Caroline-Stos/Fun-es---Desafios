<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Desafio 3 - Carrinho</title>
</head>

<body>
    <!-- Lista de produtos -->
    <h1>Produtos disponíveis</h1>
    <ul>
        <li>Short - Valor R$ 80,00</li>
        <li>Tênis - Valor R$ 250,00</li>
        <li>Camiseta - Valor R$ 50,00</li>
    </ul>

    <style>
        li {
            list-style-type: none;
        }
    </style>

    <!-- Menu suspenso - selecionar o produto -->
    <label for="produto">Selecione o produto:</label>
    <select name="produto" id="produto">
        <option value="0">Short</option>
        <option value="1">Tênis</option>
        <option value="2">Camiseta</option>
    </select>

    <br><br>

    <!-- Input da quantidade do produto -->
    <label for="quantidade">Informe a quantidade:</label>
    <input type="text" id="quantidade" name="quantidade">

    <br><br>

    <!-- botao de atualizar carrinho -->
    <button id="atualizar" onclick="atualizarCarrinho()">Adicionar ao carrinho</button>

    <br><br>

    <!-- botao de ver carrinho -->
    <button id="visualizar" onclick="verCarrinho()">Ver carrinho</button>

    <h2>Carrinho</h2>

        <table id="tabela-carrinho">
            <thead>
                <tr>
                    <th>Produto</th>
                    <th>Quantidade</th>
                    <th>Valor total</th>
                </tr>
            </thead>

            <tbody></tbody>
        </table>

        <p>O valor total do carrinho
        <div id="valor-total"></div>
        </p>

    <script>

        const produtosDisponiveis = ['Short', 'Tênis', 'Camiseta'];
        const precos = [80.00, 250.00, 50.00];
        let quantidades = [0, 0, 0];

        const tabela = document.getElementById("tabela-carrinho");

        function atualizarCarrinho(produto, quantidade) {

            produto = produtosDisponiveis[document.getElementById("produto").value];
            quantidade = parseFloat(document.getElementById("quantidade").value);

            const index = produtosDisponiveis.indexOf(produto);
            if (index !== -1) {
                quantidades[index] += quantidade;
                alert(`Produto "${produto}" adicionado`);
            } else {
                alert("Produto não encontrado.");
            }
        };

        function verCarrinho() {

            function calcularValorTotal() {
                let valorTotal = 0;
                for (let i = 0; i < produtosDisponiveis.length; i++) {
                    valorTotal += precos[i] * quantidade[i];
                }
                document.getElementById("valor-total").innerHTML = valorTotal;
            };

            if (quantidades === 0) {
                tabela.querySelector("tbody").innerHTML = "";
                alert("Não há produtos no carrinho.")
            } else {
                
                const tr = document.createElement("tr");
                tr.innerHTML = `
                <td>${produtosDisponiveis.produto}<td>
                <td>${quantidades.quantidade}<td>
                <td>${calcularValorTotal()}<td>
                <td><button>Remover do carrinho</button></td>
                `
                tr.querySelector("button").addEventListener("click", function () {
                    const index = quantidades.indexOf(quantidade);
                    quantidades.splice(index, 1);
                    if (tabela.contains(tr)) {
                        tabela.removeChild(tr);
                    }
                });
                tabela.querySelector("tbody").appendChild(tr);
            };
            tabela.style.display = "table";
        };

    </script>

</body>

</html>